---
interface Item {
  title: string
  description: string
  icon: 'arrow' | 'check'
  href?: string
}

interface Props {
  variant?: 'light' | 'dark'
  layout?: 'split' | 'full-width'
  preHeader: string
  headline: string
  imageUrl: string
  imageAlt: string
  items: Item[]
  pullUp?: boolean | number
}

const { 
  variant = 'light',
  layout = 'split',
  preHeader,
  headline,
  imageUrl,
  imageAlt,
  items,
  pullUp = false
} = Astro.props

// Get pull-up value in pixels (default 200px for boolean true, 0 for false)
const pullUpValue = typeof pullUp === 'number' ? pullUp : (pullUp ? 200 : 0)

const bgColor = variant === 'dark' ? 'bg-charcoal' : 'bg-white'
const textColor = variant === 'dark' ? 'text-white' : 'text-charcoal'
const textColorLight = variant === 'dark' ? 'text-white/90' : 'text-charcoal'
---

<style>
  .content-box-wrapper {
    display: grid;
    grid-template-columns: 1fr;
  }
  
  @media (min-width: 1024px) {
    .content-box-wrapper {
      grid-template-columns: 1fr 1fr;
    }
    
    .content-box-image-wrapper {
      position: relative;
      height: calc(100% + 10px) !important;
      margin-bottom: -10px;
    }
    
    .content-box-image-wrapper img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }
  
  /* Custom pull-up value using CSS variable */
  .content-box-pull-up {
    margin-top: calc(var(--pull-up-value) * -0.6);
  }
  
  @media (min-width: 640px) {
    .content-box-pull-up {
      margin-top: calc(var(--pull-up-value) * -0.8);
    }
  }
  
  @media (min-width: 768px) {
    .content-box-pull-up {
      margin-top: calc(var(--pull-up-value) * -0.85);
    }
  }
  
  @media (min-width: 1024px) {
    .content-box-pull-up {
      margin-top: calc(var(--pull-up-value) * -1);
    }
  }
</style>

<div 
  class="container-custom"
  style={pullUpValue > 0 ? `--pull-up-value: ${pullUpValue}px;` : ''}
  class:list={[
    pullUpValue === 200 && '-mt-48 sm:-mt-52 md:-mt-56 lg:-mt-[200px]',
    pullUpValue > 0 && pullUpValue !== 200 && 'content-box-pull-up'
  ]}
>
  <div class:list={[
    'relative rounded-lg shadow-2xl overflow-hidden z-10',
    bgColor
  ]}>
    {layout === 'full-width' ? (
      <!-- Full-width layout: Image on top with overlaid headlines, items below -->
      <div>
        <!-- Full-width image with overlaid headlines -->
        <div class="p-4 md:p-5 lg:p-6 pb-0">
          <div class="relative h-64 md:h-96 lg:h-[500px] rounded-lg overflow-hidden">
            <img 
              src={imageUrl}
              alt={imageAlt}
              class="w-full h-full object-cover"
            />
            <!-- Overlay with headlines -->
            <div class="absolute bottom-0 left-0 p-6 md:p-8 lg:p-10 max-w-lg">
              <p class="text-mint font-bold text-sm md:text-base mb-2 uppercase tracking-wide">
                {preHeader}
              </p>
              <h2 class="font-serif font-semibold italic text-2xl md:text-3xl lg:text-4xl text-white leading-tight">
                {headline}
              </h2>
            </div>
          </div>
        </div>
        
        <!-- Items in horizontal layout below image -->
        <div class="p-8 md:p-10 lg:p-12 pt-8 md:pt-10 lg:pt-12">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
            {items.map((item) => {
              const ItemTag = item.href ? 'a' : 'div';
              const itemProps = item.href ? { href: item.href } : {};
              
              return (
                <ItemTag 
                  {...itemProps}
                  class:list={[
                    'flex flex-col',
                    item.href && 'group cursor-pointer'
                  ]}
                >
                  <div class="flex items-start gap-3 mb-2">
                    <h3 class:list={[
                      'font-sans font-bold text-xl md:text-[22px]',
                      textColor
                    ]}>
                      {item.title}
                    </h3>
                    {item.icon === 'check' && (
                      <svg 
                        class="w-6 h-6 text-mint flex-shrink-0 mt-1" 
                        fill="currentColor" 
                        viewBox="0 0 20 20" 
                        aria-hidden="true"
                      >
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                      </svg>
                    )}
                  </div>
                  <p class:list={[
                    'text-base md:text-lg leading-relaxed',
                    textColorLight
                  ]}>
                    {item.description}
                  </p>
                </ItemTag>
              );
            })}
          </div>
        </div>
      </div>
    ) : (
      <!-- Split layout: Image left, content right (default) -->
      <div class="content-box-wrapper">
        <!-- Image - Left Half -->
        <div class="content-box-image-wrapper h-64 md:h-96">
          <img 
            src={imageUrl}
            alt={imageAlt}
            class="w-full h-full object-cover"
          />
        </div>
        
        <!-- Content - Right Half -->
        <div class="p-8 md:p-10 lg:p-12">
          <!-- Pre-header -->
          <p class="text-mint font-bold text-base mb-4 uppercase tracking-wide">
            {preHeader}
          </p>
          
          <!-- Header -->
          <h2 class:list={[
            'font-serif font-semibold italic text-3xl md:text-4xl leading-tight mb-8',
            textColor
          ]}>
            {headline}
          </h2>
          
          <!-- Items List -->
          <div class="space-y-6">
            {items.map((item) => {
              const ItemTag = item.href ? 'a' : 'div';
              const itemProps = item.href ? { href: item.href } : {};
              
              return (
                <ItemTag 
                  {...itemProps}
                  class:list={[
                    'flex items-center justify-between',
                    item.href && 'group cursor-pointer'
                  ]}
                >
                  <div class="flex-1">
                    <h3 class:list={[
                      'font-sans font-bold text-xl md:text-[22px] mb-1',
                      textColor
                    ]}>
                      {item.title}
                    </h3>
                    <p class:list={[
                      'text-base md:text-lg leading-relaxed',
                      textColorLight
                    ]}>
                      {item.description}
                    </p>
                  </div>
                  
                  {item.icon === 'arrow' && (
                    <svg 
                      class:list={[
                        'w-5 h-5 md:w-6 md:h-6 text-mint flex-shrink-0 ml-4',
                        item.href && 'transition-transform group-hover:translate-x-1'
                      ]}
                      fill="none" 
                      stroke="currentColor" 
                      viewBox="0 0 24 24" 
                      aria-hidden="true"
                    >
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                  )}
                  
                  {item.icon === 'check' && (
                    <svg 
                      class="w-6 h-6 text-mint flex-shrink-0" 
                      fill="currentColor" 
                      viewBox="0 0 20 20" 
                      aria-hidden="true"
                    >
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                    </svg>
                  )}
                </ItemTag>
              );
            })}
          </div>
        </div>
      </div>
    )}
  </div>
</div>


