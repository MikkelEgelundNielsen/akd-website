---
/**
 * VidensbaseHero Component
 * Forest green hero section with:
 * - Pre-header + headline (with mint accent)
 * - Rounded search input
 * - Popular topic chips
 */

import { portableTextToHtml } from '@/lib/portableTextSerializer'
import type { VidensbasePage } from '@/types/sanity'

interface Props {
  page: VidensbasePage | null
}

const { page } = Astro.props

// Convert hero portable text to HTML
const preHeadline = page?.hero?.preHeadline || 'DYRKNING OG RÅDGIVNING'

const headlineHtml = page?.hero?.headline
  ? portableTextToHtml(page.hero.headline, { addHeadingIds: false })
  : 'ET SAMLET KARTOTEK <span class="font-serif italic text-mint">med alt du bør vide</span> FOR AT FÅ MEST UD AF DIN KARTOFFELAVL'

const searchPlaceholder = page?.searchPlaceholder || 'Hvad søger du efter…?'
const popularTopics = page?.popularTopics || []
---

<section class="relative bg-forest-green pt-12 md:pt-16 lg:pt-20 pb-24 md:pb-28 lg:pb-32 section-after-nav">
  <div class="container-custom">
    <!-- Pre-headline -->
    <p class="text-mint font-bold text-base mb-6 uppercase tracking-wide text-center">
      {preHeadline}
    </p>
    
    <!-- Main Headline -->
    <h1 class="text-center mb-8 md:mb-10 max-w-4xl mx-auto">
      <span 
        class="block font-sans font-extrabold text-[32px] md:text-[43px] lg:text-[52px] text-white uppercase leading-tight [&_.font-serif]:lowercase [&_.font-serif]:font-medium" 
        set:html={headlineHtml} 
      />
    </h1>
    
    <!-- Search Input -->
    <div class="max-w-2xl mx-auto mb-6">
      <div class="relative">
        <input 
          type="text" 
          id="vidensbase-search"
          placeholder={searchPlaceholder}
          class="w-full bg-white/15 border border-white/30 text-white placeholder-white/60 rounded-full py-4 pl-6 pr-14 text-base focus:outline-none focus:border-white/60 focus:bg-white/20 transition-all"
        />
        <button 
          type="button"
          id="vidensbase-search-btn"
          class="absolute right-2 top-1/2 -translate-y-1/2 w-10 h-10 flex items-center justify-center rounded-full bg-white/20 hover:bg-white/30 transition-colors"
          aria-label="Søg"
        >
          <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- Popular Topics -->
    {popularTopics.length > 0 && (
      <div class="max-w-2xl mx-auto text-center">
        <p class="text-sm text-white/60 mb-3">Populære emner:</p>
        <div class="flex flex-wrap justify-center gap-2">
          {popularTopics.map((topic) => (
            <a 
              href={topic.link ? `${topic.link}#topic-nav` : '#'}
              class="inline-block px-4 py-1.5 bg-white/10 border border-white/20 rounded-full text-sm text-white hover:bg-white/20 hover:border-white/40 transition-all"
            >
              {topic.label}
            </a>
          ))}
        </div>
      </div>
    )}
  </div>
</section>
