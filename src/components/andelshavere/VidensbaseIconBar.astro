---
/**
 * VidensbaseIconBar Component
 * Horizontal icon bar showing topic categories.
 * Negatively pulled up to overlap the hero section.
 * Each icon links to its topic page.
 */

import type { VidensbaseTopic } from '@/types/sanity'

interface Props {
  categories: Pick<VidensbaseTopic, '_id' | 'title' | 'slug' | 'icon' | 'shortLabel'>[]
  activeSlug?: string
}

const { categories, activeSlug } = Astro.props

// SVG icon map for each icon type
const iconSvgs: Record<string, string> = {
  bug: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 12c2.21 0 4-1.79 4-4V6l2-2m-2 2h-2m-4 6c-2.21 0-4-1.79-4-4V6L4 4m2 2h2m4 14c-3.31 0-6-2.69-6-6v-2h12v2c0 3.31-2.69 6-6 6zm0 0v2m-3-1h6M9 8h6"/>`,
  mushroom: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 20v-6m0 0c-4.418 0-8-2.686-8-6s3.582-6 8-6 8 2.686 8 6-3.582 6-8 6zm-2 6h4"/>`,
  weed: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 21V12m0 0c0-3-2-5-5-7m5 7c0-3 2-5 5-7M7 21c1.5-2 3.5-3.5 5-3.5S14.5 19 16 21M5 10c1.5 0 3 .5 4 1.5M19 10c-1.5 0-3 .5-4 1.5"/>`,
  flask: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 3h6m-5 0v5.172a2 2 0 01-.586 1.414l-3.828 3.828A3 3 0 007.708 19h8.584a3 3 0 002.122-5.121l-3.828-3.828A2 2 0 0114 8.636V3m-4 0h4"/>`,
  seedling: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 21V12m0 0c0-3.5 3-6.5 7-7-1 4-3.5 7-7 7zm0 0c0-3.5-3-6.5-7-7 1 4 3.5 7 7 7z"/>`,
  warehouse: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 21h18M3 7l9-4 9 4M4 7v14m16-14v14M8 11h2m4 0h2M8 15h2m4 0h2"/>`,
  grain: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 21c0-4 2-7 5-9-3-1-5-4-5-8 0 4-2 7-5 8 3 2 5 5 5 9zm0-18v18M7 8c1 1 2.5 2 5 2m0 5c2.5 0 4-1 5-2"/>`,
  water: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 21c-3.866 0-7-2.91-7-6.5S12 3 12 3s7 8.09 7 11.5-3.134 6.5-7 6.5z"/>`,
  research: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-4.35-4.35M10 6v4m-2-2h4m5 2a7 7 0 11-14 0 7 7 0 0114 0z"/>`,
  clipboard: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>`,
  shovel: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.5 3.5l6 6m-6-6l-1 1 6 6 1-1m-7 0l-7.5 7.5a2.12 2.12 0 01-3-3L10.5 6.5"/>`,
  shield: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>`,
  recycle: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 12l1.5-3 3 1.5M20 12l-1.5 3-3-1.5M12 4l3 1.5-1.5 3M7.86 16.14A4 4 0 0112 18a4 4 0 014.14-1.86M16.14 7.86A4 4 0 0112 6a4 4 0 00-4.14 1.86"/>`,
  layers: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>`,
  link: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>`,
  newspaper: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>`,
}
---

<div class="relative z-10 iconbar-pull-up" id="topic-nav">
  <div class="container-custom">
    <div class="bg-white rounded-2xl shadow-xl px-4 py-5 md:px-6 md:py-6">
      <div class="flex gap-2 md:gap-3 overflow-x-auto scrollbar-hide pb-1">
        {categories.map((cat) => {
          const isActive = cat.slug === activeSlug
          return (
            <a
              href={`/andelshavere/vidensbasen/${cat.slug}#topic-nav`}
              class:list={[
                "icon-item flex flex-col items-center gap-2 flex-1 min-w-fit px-3 py-3 rounded-xl transition-all text-center group",
                isActive 
                  ? "bg-forest-green text-white" 
                  : "hover:bg-warm-light text-charcoal"
              ]}
              aria-current={isActive ? 'page' : undefined}
            >
              <div class:list={[
                "w-10 h-10 md:w-12 md:h-12 rounded-full flex items-center justify-center transition-colors",
                isActive
                  ? "bg-white/20"
                  : "bg-forest-green/10 group-hover:bg-forest-green/15"
              ]}>
                <svg 
                  class:list={[
                    "w-5 h-5 md:w-6 md:h-6",
                    isActive ? "text-white" : "text-forest-green"
                  ]}
                  fill="none" 
                  stroke="currentColor" 
                  viewBox="0 0 24 24" 
                  aria-hidden="true"
                >
                  <Fragment set:html={iconSvgs[cat.icon] || iconSvgs.clipboard} />
                </svg>
              </div>
              <span class:list={[
                "text-xs md:text-sm font-medium leading-tight whitespace-nowrap",
                isActive ? "text-white" : "text-charcoal/80"
              ]}>
                {cat.shortLabel}
              </span>
            </a>
          )
        })}
      </div>
    </div>
  </div>
</div>

<style>
  .iconbar-pull-up {
    margin-top: -2.5rem;
    scroll-margin-top: 6rem;
  }

  @media (min-width: 768px) {
    .iconbar-pull-up {
      margin-top: -3rem;
    }
  }

  @media (min-width: 1024px) {
    .iconbar-pull-up {
      margin-top: -3.5rem;
    }
  }

  /* Hide scrollbar but keep scrolling */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
</style>
